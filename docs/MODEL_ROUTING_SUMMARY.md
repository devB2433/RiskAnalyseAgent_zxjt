# æ¨¡å‹è·¯ç”±å±‚å®ç°æ€»ç»“

## âœ… å·²å®Œæˆçš„åŠŸèƒ½

### 1. æ ¸å¿ƒæ¶æ„

#### åŸºç¡€ç±» (`base.py`)
- âœ… `ModelConfig`: æ¨¡å‹é…ç½®ç±»
- âœ… `ModelProvider`: æ¨¡å‹æä¾›å•†æšä¸¾
- âœ… `ModelCapability`: æ¨¡å‹èƒ½åŠ›æšä¸¾
- âœ… `TaskComplexity`: ä»»åŠ¡å¤æ‚åº¦æšä¸¾
- âœ… `RoutingContext`: è·¯ç”±ä¸Šä¸‹æ–‡
- âœ… `RoutingDecision`: è·¯ç”±å†³ç­–ç»“æœ
- âœ… `RoutingStrategy`: è·¯ç”±ç­–ç•¥åŸºç±»

#### æ¨¡å‹æ³¨å†Œè¡¨ (`registry.py`)
- âœ… é¢„æ³¨å†Œ9ä¸ªä¸»æµæ¨¡å‹ï¼ˆOpenAIã€Anthropicã€æ™ºè°±AIï¼‰
- âœ… æ¨¡å‹æ³¨å†Œ/æ³¨é”€åŠŸèƒ½
- âœ… æŒ‰æä¾›å•†/èƒ½åŠ›/æˆæœ¬ç­›é€‰æ¨¡å‹
- âœ… åˆ›å»ºLLMå®ä¾‹
- âœ… æ¨¡å‹ç»Ÿè®¡åŠŸèƒ½

### 2. ä¸‰ç§è·¯ç”±ç­–ç•¥ (`strategies.py`)

#### è§„åˆ™è·¯ç”± (RuleBasedRoutingStrategy)
- âœ… é¢„å®šä¹‰ä»»åŠ¡ç±»å‹åˆ°æ¨¡å‹çš„æ˜ å°„
- âœ… æ”¯æŒæŒ‰ä»»åŠ¡ç±»å‹è·¯ç”±
- âœ… æ”¯æŒæŒ‰å¤æ‚åº¦è·¯ç”±
- âœ… åŠ¨æ€æ·»åŠ /åˆ é™¤è§„åˆ™
- âœ… é»˜è®¤è§„åˆ™è¦†ç›–å¸¸è§åœºæ™¯

#### æ™ºèƒ½è·¯ç”± (IntelligentRoutingStrategy)
- âœ… ä½¿ç”¨å°æ¨¡å‹åˆ†æä»»åŠ¡ç‰¹å¾
- âœ… AIè‡ªåŠ¨é€‰æ‹©æœ€ä¼˜æ¨¡å‹
- âœ… è€ƒè™‘ä»»åŠ¡å¤æ‚åº¦ã€èƒ½åŠ›éœ€æ±‚ã€æˆæœ¬ã€è´¨é‡
- âœ… è¿”å›ç½®ä¿¡åº¦å’Œé€‰æ‹©åŸå› 
- âœ… JSONæ ¼å¼è§£æå’Œé”™è¯¯å¤„ç†

#### é…ç½®è·¯ç”± (ConfigBasedRoutingStrategy)
- âœ… ä¸ºæ¯ä¸ªAgenté…ç½®ä¸“ç”¨æ¨¡å‹
- âœ… æ”¯æŒé…ç½®æ–‡ä»¶æŒä¹…åŒ–
- âœ… åŠ è½½/ä¿å­˜JSONé…ç½®
- âœ… é»˜è®¤æ¨¡å‹è®¾ç½®
- âœ… åŠ¨æ€é…ç½®ç®¡ç†

### 3. ç»Ÿä¸€è·¯ç”±å™¨ (`router.py`)
- âœ… æ•´åˆä¸‰ç§è·¯ç”±ç­–ç•¥
- âœ… ç»Ÿä¸€çš„è·¯ç”±æ¥å£
- âœ… ç­–ç•¥åˆ‡æ¢å’Œç®¡ç†
- âœ… å¸¦å›é€€çš„è·¯ç”±æœºåˆ¶
- âœ… ç›´æ¥åˆ›å»ºLLMå®ä¾‹
- âœ… æ¨¡å‹è¿‡æ»¤ï¼ˆèƒ½åŠ›ã€æˆæœ¬ã€è´¨é‡ï¼‰
- âœ… æ¨¡å‹ç»Ÿè®¡ä¿¡æ¯

### 4. æ¡†æ¶é›†æˆ (`agent_framework_v2.py`)
- âœ… å‘åå…¼å®¹çš„æ¡†æ¶å¢å¼ºç‰ˆ
- âœ… å¯é€‰å¯ç”¨æ¨¡å‹è·¯ç”±
- âœ… æ‰€æœ‰ç»„ä»¶æ”¯æŒè·¯ç”±
- âœ… åŒ…è£…ç±»å®ç°åŠ¨æ€LLMè·å–
- âœ… å¿«æ·æ–¹æ³•ï¼ˆadd_rule, set_agent_modelç­‰ï¼‰

### 5. æ–‡æ¡£å’Œç¤ºä¾‹
- âœ… å®Œæ•´çš„READMEæ–‡æ¡£
- âœ… 6ä¸ªè¯¦ç»†ä½¿ç”¨ç¤ºä¾‹
- âœ… æœ€ä½³å®è·µæŒ‡å—
- âœ… æ€§èƒ½å¯¹æ¯”è¡¨
- âœ… æ•…éšœæ’é™¤æŒ‡å—

## ğŸ“Š æ”¯æŒçš„æ¨¡å‹

### OpenAI (3ä¸ª)
- GPT-4o: è´¨é‡9.5/10, é€Ÿåº¦7/10, $0.03/1k
- GPT-4o-mini: è´¨é‡8/10, é€Ÿåº¦9/10, $0.0015/1k
- GPT-3.5-turbo: è´¨é‡7/10, é€Ÿåº¦9.5/10, $0.001/1k

### Anthropic Claude (3ä¸ª)
- Claude-3-opus: è´¨é‡10/10, é€Ÿåº¦6/10, $0.075/1k
- Claude-3-sonnet: è´¨é‡9/10, é€Ÿåº¦8/10, $0.015/1k
- Claude-3-haiku: è´¨é‡7.5/10, é€Ÿåº¦9.5/10, $0.0025/1k

### æ™ºè°±AI (3ä¸ª)
- GLM-4: è´¨é‡8.5/10, é€Ÿåº¦7.5/10, $0.01/1k
- GLM-4-flash: è´¨é‡7/10, é€Ÿåº¦10/10, $0.0001/1k
- GLM-3-turbo: è´¨é‡6.5/10, é€Ÿåº¦9/10, $0.0005/1k

## ğŸ¯ ä¸‰ç§è·¯ç”±ç­–ç•¥å¯¹æ¯”

| ç­–ç•¥ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|----------|
| **è§„åˆ™è·¯ç”±** | å¿«é€Ÿã€ç¡®å®šæ€§å¼ºã€æ˜“ç†è§£ | éœ€è¦é¢„å®šä¹‰è§„åˆ™ã€ä¸å¤Ÿçµæ´» | ä»»åŠ¡ç±»å‹æ˜ç¡®ã€éœ€è¦å¿«é€Ÿå†³ç­– |
| **æ™ºèƒ½è·¯ç”±** | è‡ªåŠ¨åˆ†æã€æœ€ä¼˜é€‰æ‹©ã€é€‚åº”æ€§å¼º | éœ€è¦é¢å¤–APIè°ƒç”¨ã€ç¨æ…¢ | ä»»åŠ¡ç±»å‹ä¸ç¡®å®šã€éœ€è¦æœ€ä¼˜é€‰æ‹© |
| **é…ç½®è·¯ç”±** | ç²¾ç¡®æ§åˆ¶ã€å¯æŒä¹…åŒ–ã€æ˜“ç®¡ç† | éœ€è¦æ‰‹åŠ¨é…ç½®ã€ç»´æŠ¤æˆæœ¬ | å¤šAgentç³»ç»Ÿã€éœ€è¦ç²¾ç»†æ§åˆ¶ |

## ğŸ’¡ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šç®€å•ä»»åŠ¡å¿«é€Ÿå¤„ç†
```python
# ä½¿ç”¨è§„åˆ™è·¯ç”± + ä¾¿å®œå¿«é€Ÿæ¨¡å‹
router.add_rule("simple_qa", "glm-4-flash")
decision = await router.route(task_type="simple_qa")
# â†’ é€‰æ‹© glm-4-flash ($0.0001/1k, é€Ÿåº¦10/10)
```

### åœºæ™¯2ï¼šå¤æ‚ä»»åŠ¡é«˜è´¨é‡
```python
# ä½¿ç”¨æ™ºèƒ½è·¯ç”± + è´¨é‡è¦æ±‚
decision = await router.route(
    task_type="complex_analysis",
    complexity=TaskComplexity.VERY_COMPLEX,
    min_quality=9.0
)
# â†’ AIé€‰æ‹© claude-3-opus æˆ– gpt-4o
```

### åœºæ™¯3ï¼šå¤šAgentç³»ç»Ÿ
```python
# ä½¿ç”¨é…ç½®è·¯ç”± + Agentä¸“ç”¨æ¨¡å‹
router.set_agent_model("security_analyzer", "gpt-4o")
router.set_agent_model("log_parser", "glm-4-flash")
router.set_agent_model("report_generator", "claude-3-sonnet")
# æ¯ä¸ªAgentä½¿ç”¨æœ€é€‚åˆçš„æ¨¡å‹
```

### åœºæ™¯4ï¼šæˆæœ¬ä¼˜åŒ–
```python
# è®¾ç½®æˆæœ¬ä¸Šé™
decision = await router.route(
    task_type="general",
    max_cost=0.005,  # æœ€å¤š $0.005/1k
    min_quality=7.0   # æœ€ä½è´¨é‡ 7/10
)
# â†’ åœ¨æˆæœ¬å’Œè´¨é‡é—´å¹³è¡¡
```

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½

### 1. è‡ªåŠ¨æ¨¡å‹é€‰æ‹©
```python
# æ ¹æ®ä»»åŠ¡è‡ªåŠ¨é€‰æ‹©
decision = await router.route(
    task_type="code_generation",
    complexity=TaskComplexity.COMPLEX
)
```

### 2. å¤šç­–ç•¥æ”¯æŒ
```python
# è§„åˆ™è·¯ç”±
decision = await router.route(task_type="translation", strategy="rule_based")

# æ™ºèƒ½è·¯ç”±
decision = await router.route(task_type="unknown", strategy="intelligent")

# é…ç½®è·¯ç”±
decision = await router.route(agent_name="my_agent", strategy="config_based")
```

### 3. å¸¦å›é€€æœºåˆ¶
```python
# å°è¯•å¤šä¸ªç­–ç•¥
decision = await router.route_with_fallback(
    task_type="my_task",
    strategies=["config_based", "rule_based", "intelligent"]
)
```

### 4. ç›´æ¥åˆ›å»ºLLM
```python
# ä¸ºä»»åŠ¡åˆ›å»ºLLM
llm = await router.create_llm_for_task(
    task_type="analysis",
    complexity=TaskComplexity.COMPLEX
)
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### æˆæœ¬ä¼˜åŒ–
- ç®€å•ä»»åŠ¡ç”¨ glm-4-flash ($0.0001/1k)
- ä¸­ç­‰ä»»åŠ¡ç”¨ gpt-4o-mini ($0.0015/1k)
- å¤æ‚ä»»åŠ¡ç”¨ gpt-4o ($0.03/1k)
- æå¤æ‚ä»»åŠ¡ç”¨ claude-3-opus ($0.075/1k)

### é€Ÿåº¦ä¼˜åŒ–
- å®æ—¶åº”ç”¨: glm-4-flash (é€Ÿåº¦10/10)
- å¿«é€Ÿå“åº”: gpt-3.5-turbo (é€Ÿåº¦9.5/10)
- å¹³è¡¡: gpt-4o-mini (é€Ÿåº¦9/10)

### è´¨é‡ä¼˜åŒ–
- å…³é”®ä»»åŠ¡: claude-3-opus (è´¨é‡10/10)
- é‡è¦ä»»åŠ¡: gpt-4o (è´¨é‡9.5/10)
- ä¸€èˆ¬ä»»åŠ¡: claude-3-sonnet (è´¨é‡9/10)

## ğŸ“ ç¤ºä¾‹ä»£ç 

### å®Œæ•´ç¤ºä¾‹
```bash
# è¿è¡Œæ¨¡å‹è·¯ç”±ç¤ºä¾‹
python examples/model_routing_examples.py
```

### ç¤ºä¾‹å†…å®¹
1. åŸºäºè§„åˆ™çš„è·¯ç”±
2. æ™ºèƒ½è·¯ç”±
3. é…ç½®åŒ–è·¯ç”±
4. æ··åˆä½¿ç”¨ç­–ç•¥
5. ç›´æ¥åˆ›å»ºLLM
6. æ¨¡å‹ç»Ÿè®¡ä¿¡æ¯

## ğŸ“ é…ç½®æ–‡ä»¶ç¤ºä¾‹

### agent_models.json
```json
{
  "compromised_host_analyzer": "gpt-4o",
  "anomalous_login_analyzer": "claude-3-sonnet",
  "data_exfiltration_analyzer": "gpt-4o",
  "malware_detector": "claude-3-opus",
  "simple_classifier": "glm-4-flash",
  "log_parser": "gpt-3.5-turbo"
}
```

## ğŸš€ ä¸‹ä¸€æ­¥

### å¯èƒ½çš„æ‰©å±•
1. æ·»åŠ æ›´å¤šæ¨¡å‹æä¾›å•†ï¼ˆGoogleã€Baiduç­‰ï¼‰
2. å®ç°æ¨¡å‹æ€§èƒ½ç›‘æ§
3. æ·»åŠ æ¨¡å‹è´Ÿè½½å‡è¡¡
4. å®ç°æ¨¡å‹ç¼“å­˜æœºåˆ¶
5. æ”¯æŒæ¨¡å‹ç‰ˆæœ¬ç®¡ç†
6. æ·»åŠ A/Bæµ‹è¯•åŠŸèƒ½
7. å®ç°æˆæœ¬è¿½è¸ªå’ŒæŠ¥å‘Š

## ğŸ“š æ–‡æ¡£

- [æ¨¡å‹è·¯ç”±å±‚README](src/model_routing/README.md)
- [ä½¿ç”¨ç¤ºä¾‹](examples/model_routing_examples.py)
- [ä¸»README](README.md)

## âœ¨ æ€»ç»“

æ¨¡å‹è·¯ç”±å±‚ä¸ºAgentæ¡†æ¶æä¾›äº†å¼ºå¤§çš„å¤šæ¨¡å‹ç®¡ç†èƒ½åŠ›ï¼š

1. **ä¸‰ç§è·¯ç”±ç­–ç•¥**æ»¡è¶³ä¸åŒåœºæ™¯éœ€æ±‚
2. **9ä¸ªé¢„æ³¨å†Œæ¨¡å‹**è¦†ç›–ä¸»æµæä¾›å•†
3. **æ™ºèƒ½é€‰æ‹©**åœ¨æˆæœ¬ã€è´¨é‡ã€é€Ÿåº¦é—´å¹³è¡¡
4. **çµæ´»é…ç½®**æ”¯æŒç²¾ç»†åŒ–æ§åˆ¶
5. **å®Œæ•´æ–‡æ¡£**å’Œç¤ºä¾‹ä»£ç 

è¿™ä½¿å¾—æ¡†æ¶èƒ½å¤Ÿï¼š
- æ ¹æ®ä»»åŠ¡è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜æ¨¡å‹
- ä¸ºä¸åŒAgenté…ç½®ä¸“ç”¨æ¨¡å‹
- åœ¨æˆæœ¬å’Œè´¨é‡é—´æ™ºèƒ½å¹³è¡¡
- æ”¯æŒå¤šç§æ¨¡å‹æä¾›å•†
- æ˜“äºæ‰©å±•å’Œå®šåˆ¶